# 以太坊（Ethereum）学习框架

> **口诀：终局定方向，流程搭骨架，单点打通关，类比挂认知，闭环验真知。**

---

## 1. 终极目标（WHY - 终局锚定）

### 解决的核心问题

以太坊解决的是：**如何在没有中间人的情况下，让陌生人之间可以安全地执行复杂的协议和交易？**

传统世界中，我们需要银行、律师、公证处等中介来保证交易的执行。以太坊通过「智能合约」让代码成为不可篡改的「中间人」，实现了「代码即法律」。

### 最终交付物

学完以太坊，你将能够：
- 独立创建和管理以太坊钱包
- 理解并发起链上交易
- 阅读和理解简单的智能合约代码
- 与 DeFi 协议进行基本交互
- 理解区块链浏览器上的所有信息

### 评判标准

- 能向完全不懂区块链的人解释「以太坊是什么」
- 能独立完成一笔链上转账（测试网即可）
- 能部署一个简单的智能合约
- 能解释 Gas 费用的计算逻辑

### 验收任务

**独立完成以下任务**：在测试网上部署一个简单的 ERC-20 代币合约，并能解释每一行代码的作用，以及为什么选择这种实现方式。

---

## 2. 流程全景图（WHAT - 流程串联）

### 以太坊世界的核心流程

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        以太坊交易生命周期                                      │
└─────────────────────────────────────────────────────────────────────────────┘

用户视角：
┌──────────┐    ┌──────────┐    ┌──────────┐    ┌──────────┐    ┌──────────┐
│  创建    │    │  签名    │    │  广播    │    │  确认    │    │  完成    │
│  钱包    │ -> │  交易    │ -> │  交易    │ -> │  等待    │ -> │  上链    │
└──────────┘    └──────────┘    └──────────┘    └──────────┘    └──────────┘
     │               │               │               │               │
     v               v               v               v               v
  生成密钥对      用私钥签名      发送到节点      进入内存池      打包进区块
  得到地址       构造交易数据    传播到网络      验证者排序      状态更新


网络视角：
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│   ┌─────────┐     ┌─────────┐     ┌─────────┐     ┌─────────┐              │
│   │ 节点 A  │ <-> │ 节点 B  │ <-> │ 节点 C  │ <-> │ 节点 D  │  ...         │
│   └─────────┘     └─────────┘     └─────────┘     └─────────┘              │
│        │               │               │               │                   │
│        v               v               v               v                   │
│   ┌─────────────────────────────────────────────────────────────┐         │
│   │                    共享的世界状态                             │         │
│   │  账户余额 | 合约代码 | 合约存储 | Nonce值                     │         │
│   └─────────────────────────────────────────────────────────────┘         │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘


区块结构：
┌─────────────────────────────────────────────────────────────────────────────┐
│  区块 N                                                                     │
├─────────────────────────────────────────────────────────────────────────────┤
│  区块头：                                                                    │
│  ├─ 父区块哈希（指向区块 N-1）                                               │
│  ├─ 状态根（所有账户状态的默克尔树根）                                        │
│  ├─ 交易根（所有交易的默克尔树根）                                            │
│  ├─ 时间戳                                                                  │
│  └─ 其他元数据                                                              │
├─────────────────────────────────────────────────────────────────────────────┤
│  交易列表：                                                                  │
│  ├─ 交易 1：Alice -> Bob, 1 ETH                                            │
│  ├─ 交易 2：Charlie 调用合约 0x123...                                       │
│  └─ 交易 3：...                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
         │
         v
┌─────────────────────────────────────────────────────────────────────────────┐
│  区块 N+1                                                                   │
│  ...                                                                        │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 智能合约执行流程

```
┌──────────────────────────────────────────────────────────────────────────┐
│                      智能合约调用流程                                      │
└──────────────────────────────────────────────────────────────────────────┘

     用户发起交易
          │
          v
    ┌───────────┐
    │ 指定合约  │  <- 目标地址是合约地址
    │ 地址和数据│  <- data 字段包含调用信息
    └───────────┘
          │
          v
    ┌───────────┐
    │  EVM 启动 │  <- 以太坊虚拟机开始执行
    └───────────┘
          │
          v
    ┌───────────┐     ┌─────────────────────┐
    │ 解析调用  │ ->  │ 函数选择器（4字节） │
    │   数据    │     │ + 参数编码          │
    └───────────┘     └─────────────────────┘
          │
          v
    ┌───────────┐
    │ 执行合约  │  <- 逐条执行字节码指令
    │   代码    │  <- 每条指令消耗 Gas
    └───────────┘
          │
          ├─────────────────┬─────────────────┐
          v                 v                 v
    ┌───────────┐     ┌───────────┐     ┌───────────┐
    │ 读取状态  │     │ 修改状态  │     │ 调用其他  │
    │  (SLOAD)  │     │  (SSTORE) │     │   合约    │
    └───────────┘     └───────────┘     └───────────┘
          │                 │                 │
          └─────────────────┴─────────────────┘
                            │
                            v
                  ┌───────────────────┐
                  │  执行成功/失败？  │
                  └───────────────────┘
                     │           │
              成功    │           │  失败
                     v           v
              ┌──────────┐  ┌──────────┐
              │ 状态提交 │  │ 状态回滚 │
              │ 扣除Gas  │  │ 扣除Gas  │
              │ 触发事件 │  │ 返回错误 │
              └──────────┘  └──────────┘
```

---

## 3. 核心概念导航

| 序号 | 概念 | 一句话解释 | 详细教程 |
|------|------|-----------|----------|
| 01 | 区块链基础 | 一个所有人共同维护的、不可篡改的账本 | [查看](tutorials/01-blockchain-basics.md) |
| 02 | 以太坊账户 | 你在以太坊世界的身份证和银行卡 | [查看](tutorials/02-ethereum-accounts.md) |
| 03 | Gas 机制 | 以太坊的「燃料费」，防止网络被滥用 | [查看](tutorials/03-gas-mechanism.md) |
| 04 | 智能合约 | 存在区块链上、自动执行的程序代码 | [查看](tutorials/04-smart-contracts.md) |
| 05 | EVM 虚拟机 | 运行智能合约的「计算机」 | [查看](tutorials/05-evm.md) |
| 06 | 交易与签名 | 在以太坊上「说话」和「证明身份」的方式 | [查看](tutorials/06-transactions.md) |
| 07 | 共识机制（PoS）| 网络如何就「谁说了算」达成一致 | [查看](tutorials/07-consensus-pos.md) |
| 08 | DeFi 基础 | 用代码重建金融系统 | [查看](tutorials/08-defi-basics.md) |

---

## 4. 实战案例

[查看单点穿透案例：从零部署你的第一个代币](tutorials/case-study.md)

---

## 5. 锚定迁移（新旧知识连接）

| 以太坊概念 | 现实世界类比 |
|-----------|-------------|
| 区块链 | 全村人都有一份的账本，任何人篡改大家都知道 |
| 钱包地址 | 银行卡号（可以公开） |
| 私钥 | 银行卡密码+U盾（绝对不能泄露） |
| Gas | 寄快递的运费，东西越重越贵 |
| 智能合约 | 自动售货机：投币+按按钮=出货，没有人能干预 |
| EVM | 每个节点都有的相同计算器 |
| 交易 | 填写并签名的转账单 |
| 区块 | 账本的一页，记录了多笔交易 |
| 共识 | 全村人投票决定账本怎么记 |
| DeFi | 用代码替代银行、交易所、保险公司 |

---

## 6. 学习自检清单

### 费曼检验
- [ ] 我能用3分钟向朋友解释「什么是以太坊，它和比特币有什么区别」
- [ ] 我能解释「为什么区块链不可篡改」
- [ ] 我能说清楚「智能合约为什么叫智能」

### 迁移检验
- [ ] 我能独立完成一笔测试网转账
- [ ] 我能看懂区块浏览器上的交易详情
- [ ] 我能独立部署一个简单的智能合约

### 深度检验
- [ ] 我能解释 Gas Price 和 Gas Limit 的区别
- [ ] 我能说出交易从发起到确认的完整流程
- [ ] 我能解释为什么以太坊从 PoW 转向 PoS

---

## 7. 推荐学习顺序

```
第一阶段：建立认知框架（1-2天）
├── 01-blockchain-basics.md  <- 先理解区块链是什么
├── 02-ethereum-accounts.md  <- 理解钱包和账户
└── 06-transactions.md       <- 理解交易是如何工作的

第二阶段：理解核心机制（2-3天）
├── 03-gas-mechanism.md      <- 理解费用机制
├── 05-evm.md               <- 理解执行环境
└── 07-consensus-pos.md     <- 理解网络如何达成共识

第三阶段：进入智能合约（3-5天）
├── 04-smart-contracts.md   <- 核心：智能合约开发
└── case-study.md           <- 实战：部署你的代币

第四阶段：探索应用层（持续）
└── 08-defi-basics.md       <- 了解去中心化金融
```

---

## 8. 资源链接

### 官方资源
- [以太坊官网](https://ethereum.org/zh/)
- [以太坊开发者文档](https://ethereum.org/zh/developers/docs/)
- [Solidity 文档](https://docs.soliditylang.org/)

### 工具
- [Remix IDE](https://remix.ethereum.org/) - 在线智能合约开发环境
- [Etherscan](https://etherscan.io/) - 以太坊区块浏览器
- [MetaMask](https://metamask.io/) - 最流行的以太坊钱包

### 测试网水龙头
- [Sepolia Faucet](https://sepoliafaucet.com/) - 获取测试网 ETH

---

> 记住：学习区块链最好的方式是**动手实践**。看十遍不如做一遍，做一遍不如踩一次坑！
