# 钱包与私钥 (Wallet & Keys)

## 一句话大白话

**私钥是你在 Web3 世界的唯一身份证明，丢了就真的永远没了。**

打个比方：私钥就像你家的钥匙，但这把钥匙没有备份、没有开锁公司、没有房东。丢了就永远进不了家门，里面的东西永远拿不出来。

---

## 它解决什么问题

### 传统问题：身份由他人控制

在传统互联网：
- 微信账号被封 → 你的社交关系没了
- 支付宝被冻结 → 你的钱取不出来
- 游戏停运 → 你充的钱、练的号都没了

**本质问题**：你的身份和资产都「存」在别人的服务器上，他们说删就删。

### Web3 的解决方案：自己掌控身份

在 Web3：
- 你的私钥 = 你的身份
- 只有你能控制你的资产
- 没有人能「封」你的账号
- 没有人能「冻结」你的资产

**代价**：你要自己保管好私钥，丢了没人能帮你找回。

---

## 什么时候用 / 什么时候别用

### 必须用钱包/私钥的场景

| 场景 | 说明 |
|------|------|
| 持有加密货币 | 必须有钱包才能收发 |
| 使用 DeFi 协议 | 需要钱包连接并签名授权 |
| 购买/持有 NFT | NFT 存在区块链上，需要钱包访问 |
| 参与 DAO 投票 | 用钱包证明你的身份和持仓 |

### 不同类型钱包的选择

| 钱包类型 | 适合场景 | 安全性 | 便捷性 |
|---------|---------|--------|--------|
| 热钱包（浏览器插件） | 日常小额交互 | 中 | 高 |
| 手机钱包 | 移动端使用 | 中 | 高 |
| 硬件钱包 | 大额长期存储 | 高 | 低 |
| 纸钱包 | 冷存储备份 | 高 | 最低 |

### 选择口诀
> 小钱热钱包，大钱硬件包，永远记得备份助记词

---

## 它不是什么

### 常见误解

| 误解 | 事实 |
|------|------|
| 钱包里存着我的币 | 币在区块链上，钱包只是存私钥的工具 |
| 换个钱包 App 币就没了 | 只要有私钥/助记词，任何钱包都能恢复 |
| 私钥被盗可以挂失 | 没有挂失机制，被盗就是永久损失 |
| 地址和私钥是一回事 | 地址可以公开，私钥必须保密 |
| 交易所账户 = 钱包 | 交易所是托管你的资产，私钥在他们手里 |

---

## 最小例子

### 私钥、公钥、地址的关系

```
私钥 (Private Key)
│   256位随机数，极度机密
│   例: 0x4c0883a69102937d6231471b5dbb6204fe512961708279...
│
│   ┌──────────────────────┐
│   │ 椭圆曲线加密算法      │
│   │ (单向，不可逆)        │
│   └──────────────────────┘
│
▼
公钥 (Public Key)
│   由私钥数学推导，可公开
│   例: 0x04bfcab17f5e7b4c9e1c2a3d8f...
│
│   ┌──────────────────────┐
│   │ Keccak-256 哈希      │
│   │ 取后20字节           │
│   └──────────────────────┘
│
▼
地址 (Address)
    你的「账号」，可公开分享
    例: 0x71C7656EC7ab88b098defB751B7401B5f6d8976F


重要特性：
私钥 → 公钥 → 地址  ✓ 可以
地址 → 公钥 → 私钥  ✗ 不可逆
```

### 助记词是什么

```
助记词 (Mnemonic / Seed Phrase)
┌────────────────────────────────────────────────────────┐
│ abandon ability able about above absent absorb         │
│ abstract absurd abuse access accident account          │
│                    (12-24 个英文单词)                   │
└────────────────────────────────────────────────────────┘
                           │
                           │ BIP-39 标准转换
                           ▼
┌────────────────────────────────────────────────────────┐
│              种子 (Seed)                                │
│    512位数字，用于派生所有密钥                           │
└────────────────────────────────────────────────────────┘
                           │
                           │ BIP-44 派生路径
                           ▼
┌────────────────────────────────────────────────────────┐
│  m/44'/60'/0'/0/0  →  私钥1  →  地址1                  │
│  m/44'/60'/0'/0/1  →  私钥2  →  地址2                  │
│  m/44'/60'/0'/0/2  →  私钥3  →  地址3                  │
│  ...                                                   │
└────────────────────────────────────────────────────────┘

助记词的好处：
1. 比私钥更容易备份（12个单词 vs 64位十六进制）
2. 一套助记词可以派生无限个地址
3. 跨钱包通用（只要支持 BIP-39 标准）
```

### 用 JavaScript 演示密钥生成

```javascript
const { ethers } = require('ethers');

// 生成随机钱包
const wallet = ethers.Wallet.createRandom();

console.log("助记词:", wallet.mnemonic.phrase);
// 例: "abandon ability able about above absent absorb abstract absurd abuse access accident"

console.log("私钥:", wallet.privateKey);
// 例: "0x4c0883a69102937d6231471b5dbb6204fe5129617082792ae468d01a3f362318"

console.log("公钥:", wallet.publicKey);
// 例: "0x04bfcab17f5e7b4c9e1c2a3d8f..."

console.log("地址:", wallet.address);
// 例: "0x71C7656EC7ab88b098defB751B7401B5f6d8976F"
```

### 签名是怎么回事

```
┌────────────────────────────────────────────────────────┐
│                    签名过程                             │
├────────────────────────────────────────────────────────┤
│                                                        │
│   消息: "我同意转账 1 ETH 给 Bob"                       │
│     +                                                  │
│   私钥: 0x4c0883a69102937d...                          │
│     │                                                  │
│     │ 签名算法 (ECDSA)                                 │
│     ▼                                                  │
│   签名: 0x8b9f4e7c2a1d...                              │
│                                                        │
├────────────────────────────────────────────────────────┤
│                    验证过程                             │
├────────────────────────────────────────────────────────┤
│                                                        │
│   消息: "我同意转账 1 ETH 给 Bob"                       │
│     +                                                  │
│   签名: 0x8b9f4e7c2a1d...                              │
│     │                                                  │
│     │ 验证算法                                         │
│     ▼                                                  │
│   恢复出地址: 0x71C7656EC7ab88b098defB751...           │
│     │                                                  │
│     │ 对比                                             │
│     ▼                                                  │
│   ✓ 确认是这个地址的主人签的                            │
│                                                        │
└────────────────────────────────────────────────────────┘

类比：
签名就像用你的私章盖章。别人看到章印（签名），
对比你公开的章样（地址），就能确认是你盖的。
但别人没法伪造你的章，因为他们没有你的私章（私钥）。
```

---

## 新手最常踩的 3 个坑

### 1. 助记词/私钥截图或存云端

**坑**：把助记词截图存相册，或保存到 iCloud/Google Drive。

**风险**：
- 手机被黑 → 助记词泄露
- 云账号被盗 → 资产被盗
- 手机维修时被偷看 → 资产被盗

**正解**：
- 物理备份：写在纸上，存放安全地方
- 金属备份：刻在金属板上（防火防水）
- 永远不要数字化存储助记词

### 2. 分不清「授权」和「转账」

**坑**：以为签名只是「登录」，随便签。

**风险场景**：
```
钓鱼网站弹出签名请求：
"请签名以登录"

实际内容（你没仔细看）：
approve(spender: 黑客地址, amount: 无限)

后果：
黑客获得无限转走你代币的权限
```

**正解**：
- 每次签名前仔细看内容
- 不认识的网站不要连钱包
- 定期检查并撤销不必要的授权（用 revoke.cash）

### 3. 测试网和主网搞混

**坑**：把真金白银发到测试网地址，或以为测试网的币有价值。

**后果**：
- 发到测试网 = 永久丢失
- 测试网的币一文不值

**正解**：
- 注意钱包显示的网络名称
- 主网地址和测试网地址可能相同，但资产完全隔离
- 大额转账前小额测试

---

## 流程图定位

```
┌──────┐    ┌──────────┐    ┌────────┐    ┌──────────┐    ┌────────────┐
│ 用户 │───▶│ ★创建   │───▶│ ★签名  │───▶│ 广播交易 │───▶│ 矿工打包   │
│ 意图 │    │  钱包★  │    │  交易★ │    │ 到网络   │    │ 区块       │
└──────┘    └──────────┘    └────────┘    └──────────┘    └────────────┘

钱包和私钥是用户进入 Web3 世界的入口。
- 「创建钱包」阶段：生成私钥、公钥、地址
- 「签名交易」阶段：用私钥对交易数据签名，证明是你发起的
```

---

## 自测题

1. **如果你的助记词泄露了，但你还没发现，黑客会怎么做？**

   <details>
   <summary>点击查看答案</summary>
   黑客会用你的助记词恢复钱包，然后转走所有资产。由于没有挂失机制，等你发现时可能已经太晚了。唯一的补救是在黑客行动前把资产转移到新钱包。
   </details>

2. **为什么「私钥可以推出地址」但「地址无法推出私钥」？**

   <details>
   <summary>点击查看答案</summary>
   因为使用了单向函数（椭圆曲线加密和哈希函数）。这些函数的特点是正向计算很容易，但反向计算在数学上几乎不可能（需要的计算量超过宇宙存在的时间）。
   </details>

3. **交易所账户和自己的钱包有什么本质区别？哪个更安全？**

   <details>
   <summary>点击查看答案</summary>
   本质区别：交易所账户是「托管」，私钥在交易所手里；自己的钱包是「自托管」，私钥在自己手里。

   安全性：各有利弊。
   - 交易所：可能被黑、可能跑路、可能冻结你的账户；但不怕自己弄丢私钥
   - 自托管：完全自主，但私钥丢了就永久丢失

   建议：大额长期持有用自托管（硬件钱包），小额交易可以放交易所
   </details>
